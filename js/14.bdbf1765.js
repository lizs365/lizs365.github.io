(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{641:function(n,t){n.exports="\x3c!--\ntitle: Linux脚本 \nsort: 1\n--\x3e\n\n## find\n```bash\nfind . -size +10M -print | xargs ls -lh\nfind . -size +10M -print\nfind . -mmin/-mtime -9 -print\nfind . -name *.txt -print\n```\n\n## bash\n```bash\nps -mp 12653 -o THREAD,tid,time //java进程线程及使用时间\nstrace -p xxx\npv //显示执行进度\nwatch -d date //刷新监视\nctrl+a 行首  ctrl+e 行尾\n!! //上次执行命令\n!u //上次u开头命令\nEsc + . //上一命令末参数\n\ngrep '请求方法' gateway-router.log |awk '{print $9}' | awk '{a[$1]+=1;} END {for(i in a){print a[i]\" \"i;}}' \\\n| sort -t \" \" -k 1 -n -r |head -n20\ngrep '请求方法' gateway-router.log |awk '{print $11,$2,$9}'|sort -nr |head -n20\n\nps -ef |grep hello |awk '{print $2}'|xargs kill -9\n```\n\n## vi\n```bash\n#全局替换\n:%s/vivian/sky/g\n#另存部分内容\n:start,end/$ w filename\n```\n\n## ssh\n```bash\nssh -CNfg -L 22022:xx.xxx.com:80 root@127.0.0.1\nssh -i ./id_rsa root@127.0.0.1\n```\n\n## iptables\n```iptables\n#CentOS7默认的防火墙不是iptables,而是firewalle.\n\n#先检查是否安装了iptables\nservice iptables status\n#安装iptables\nyum install -y iptables\n#升级iptables\nyum update iptables \n#安装iptables-services\nyum install iptables-services\n\n#停止firewalld服务\nsystemctl stop firewalld\n#禁用firewalld服务\nsystemctl mask firewalld\n\n#注册iptables服务\n#相当于以前的chkconfig iptables on\nsystemctl enable iptables.service\n#开启服务\nsystemctl start iptables.service\n\n#如果要添加内网ip信任（接受其所有TCP请求）\niptables -A INPUT -p tcp -s 45.96.174.68 -j ACCEPT\n\n#service iptables save\niptables-save > /etc/sysconfig/iptables\niptables-restor < iptables.bak\n\n```\n\n## screen/tmux\n```bash\n#new\nscreen -r/R name\n#Detach\nctrl-a-d/screen -d\n-x   Attach to a not detached screen. (Multi display mode).\n```\n\n## 压力测试\n```bash\n#for i in `seq 1 10`; do dd if=/dev/zero of=/dev/null & done\nstress -c 4\nstress --vm 1 --vm-bytes 400M\n\niotop\niostat -d -k 1 10         #查看TPS和吞吐量信息(磁盘读写速度单位为KB)\niostat -d -m 2            #查看TPS和吞吐量信息(磁盘读写速度单位为MB)\niostat -d -x -k 1 10      #查看设备使用率（%util）、响应时间（await） \niostat -c 1 10            #查看cpu状态\n\niostat -x -d 1            # -d表示显示I/O性能指标，-x表示显示扩展统计（即所有I/O指标）\npidstat -d 1              #显示每个进程I/O情况\n#top-%iowait -> iostat/pidstat -> strace\n#buffer/cache--pcstat/hcache\n```\n\n## 网络\n```bash\nnetstat -lnpt\nss -s //SSOCKET使用情况,比netstat更快速更高效\n\nip netns (network namespace)\n\ndmesg -T | less\ndmesg -T --level=err,warn | less\n\n###登录错误次数\npam_tally2 --user root\npam_tally2 --user root --reset\n```\n\n"}}]);